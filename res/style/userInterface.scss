@import "variables.scss";

@keyframes ui-expand {
    0% {
        left: -16rem;
    }
    70% {
        left: -1rem;
    }
    75%, 100% {
        left: 0;
    }
}

@keyframes ui-collapse {
    0% {
        left: 0;
    }
    70%, 75% {
        left: -15rem;
    }
    100% {
        left: -16rem;
    }
}

@keyframes node-expand {
    0%, 25% {
        scale: calc(min(var(--node-max-scale), 0.9));
    }
    100% {
        scale: calc(min(var(--node-max-scale), 1));
    }
}

@keyframes node-collapse {
    0% {
        scale: calc(min(var(--node-max-scale), 1));
    }
    75%, 100% {
        scale: calc(min(var(--node-max-scale), 0.9));
    }
}

#user-interface {
    display: flex;
    flex-direction: column;
    flex-wrap: wrap;
    row-gap: 1rem;

    background: $drawer-foreground;

    position: relative;
    width: 15rem;
    height: calc(100% - 3rem);
    left: -16rem;

    padding: 1rem;
    margin: auto 0;

    animation: ui-collapse 0.5s ease-out;

    border-radius: 0 $interface-radius $interface-radius 0;
    box-shadow: 5px 0 13px -3px $shadow-color;

    #selection .node {
        scale: var(--node-max-scale);
        animation: node-collapse 0.5s;
    }

    &.expanded {
        animation: ui-expand 0.5s;
        left: 0;

        #selection .node {
            animation: node-expand 0.5s;
        }
    }

    #header {
        width: 100%;
        height: 4rem;

        background: $drawer-background;
        border-radius: $interface-radius;
        box-shadow: 0 0 15px #000 inset;
    }

    #selection {
        display: flex;
        flex-direction: column;
        gap: 1.25rem;

        width: 100%;
        height: calc(100% - 5rem);

        background: $drawer-background;
        border-radius: $interface-radius;
        box-shadow: 0 0 15px #000 inset;

        overflow-y: auto;
        overflow-x: hidden;

        &::-webkit-scrollbar {
            width: 1.25rem;
            background: $scrollbar-background;
            border-radius: 0 $interface-radius $interface-radius 0;

            box-shadow: 0 0 10px #222 inset;
        }

        &::-webkit-scrollbar-thumb {
            background: $scrollbar-foreground;
            border-radius: $interface-radius;

            box-shadow: 0 0 5px #222 inset;

            &:hover {
                background: $scrollbar-hover;
                cursor: pointer;
            }
        }

        .holder {
            position: relative;

            &:first-child {
                margin-top: 1.25rem;
            }

            &:last-child {
                margin-bottom: 1.25rem;
            }

            &::before, &:last-child::after {
                content: " ";
                position: absolute;
                top: -0.675rem;
                width: 100%;
                height: 5px;
                background: $scrollbar-background;
                box-shadow: 0 0 10px $background inset;
            }

            &:last-child::after {
                top: auto;
                bottom: -0.675rem;
            }

            .node {
                --node-color: #000;

                position: relative;

                width: 80%;
                background: color-mix(in oklab, var(--node-color) 60%, #000);

                border-radius: $node-radius;
                margin: 0 auto 0 auto;

                box-shadow: 0 0 10px $background;

                &::before, &::after {
                    content: " ";
                    position: absolute;

                    top: 0;

                    width: 1.25rem;
                    height: 100%;

                    background: color-mix(in oklab, var(--node-color) 80%, #000);
                }

                &::before {
                    left: 0;

                    border-radius: $node-radius 0 0 $node-radius;
                }

                &::after {
                    right: 0;

                    border-radius: 0 $node-radius $node-radius 0;
                }

                .name {
                    position: absolute;

                    width: calc(100% - 1rem);
                    border-top-left-radius: $node-radius;
                    user-select: none;

                    background: var(--node-color);
                    text-align: center;

                    color: var(--node-name-color);
                    text-transform: uppercase;
                    font-size: 1.2rem;
                    font-family: Arial, Helvetica, sans-serif;
                }

                .input_ports, .output_ports {
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    gap: 0.5rem;

                    position: relative;

                    width: 1rem;

                    > * {
                        position: relative;

                        width: 0.5rem;
                        height: 0.5rem;

                        background: #fff;
                        border: 2px solid #ccc;
                        border-radius: 40%;

                        cursor: pointer;
                    }
                }

                .input_ports {
                    padding-top: 2.5rem;
                    padding-bottom: 1rem;

                    left: -0.5rem;
                }

                .output_ports {
                    justify-content: center;

                    position: absolute;
                    right: -0.5rem;

                    //height: calc(100% - 1.5rem);
                    //margin: 1.5rem auto 0 auto;
                    margin-top: auto;
                    padding: 0;

                    bottom: 1rem;
                    z-index: 1;
                }
            }
        }
    }

    #visuals {
        #drawer-handle {
            position: absolute;
            top: 50%;
            transform: translate(calc(0.5rem - 2px), -50%);

            fill: $drawer-foreground;
            width: 3rem;

            padding: 0.5rem;
            cursor: pointer;
            user-select: none;

            filter: drop-shadow(7px 2px 4px rgba(0, 0, 0, .7));
        }
    }
}